I"Kø<h1 id="èƒŒæ™¯é¢˜ç›®">èƒŒæ™¯é¢˜ç›®</h1>
<p>æŠ—èƒ°è…ºç™Œå€™é€‰è¯ç‰©åˆ†å­ä¼˜åŒ–å»ºæ¨¡
<img src="https://img-blog.csdnimg.cn/8080e51723b847b4abae0ddccde70258.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />Moleâ€”æ–‡ä»¶æä¾›äº†å€™é€‰è¯ç‰©åˆ†å­çš„784ä¸ªå±æ€§å€¼ï¼ŒåŒ…å«trainingå’Œtestä¸¤ä¸ªè¡¨ï¼Œåˆ†åˆ«æœ‰1974ä¸ªåˆ†å­å’Œ50ä¸ªåˆ†å­ã€‚
ERâ€”â€“æ–‡ä»¶æä¾›äº†è¿™äº›å€™é€‰åˆ†å­çš„IC50å’ŒpIC50å€¼çš„å¤§å°ï¼Œç”¨äºè¡¡é‡åˆ†å­æ´»æ€§ï¼Œå…¶ä¸­pIC50æ˜¯IC50çš„è´Ÿå¯¹æ•°ï¼Œå–è´Ÿå¯¹æ•°çš„åŸå› æ˜¯ä¸ºäº†ä½¿pIC50å¤§å°ä¸åˆ†å­æ´»æ€§å‘ˆæ­£ç›¸å…³ã€‚åŒæ ·åŒ…å«trainingè¡¨å’Œtestè¡¨ï¼Œtrainingè¡¨ä¸­åˆ†å­æ´»æ€§æ ‡å¿—å€¼pIC50å·²ç»ç»™å‡ºï¼Œtestè¡¨ä¸­çš„å€¼æœªç»™ï¼Œæ˜¯é—®äºŒéœ€è¦è‡ªå·±é¢„æµ‹çš„å€¼
é—®ä¸€ï¼šä»åˆ†å­çš„784ä¸ªå±æ€§ç‰¹å¾ä¸­ç­›é€‰å‡º20ä¸ªä¸åˆ†å­æ´»æ€§æœ€ç›¸å…³çš„å±æ€§
é—®äºŒï¼šæ ¹æ®ç­›é€‰å‡ºçš„20ä¸ªç‰¹å¾å±æ€§ï¼Œè®­ç»ƒå›å½’æ¨¡å‹ï¼Œé¢„æµ‹testè¡¨ä¸­pIC50å€¼ã€‚</p>

<h1 id="ç‰¹å¾ç­›é€‰">ç‰¹å¾ç­›é€‰</h1>
<p>è®°å½•ä¸¤ç¯‡å†™çš„æ¯”è¾ƒè¯¦ç»†çš„åšå®¢åœ°å€
<a href="https://www.cnblogs.com/nobbyoucanyouup/p/9026146.html">ç‰¹å¾é€‰æ‹©- Sklearn.feature_selectionçš„ç†è§£</a>
<a href="https://www.cnblogs.com/s1awwhy/p/14067489.html">æœºå™¨å­¦ä¹ ä¹‹ç‰¹å¾é€‰æ‹©ï¼ˆFeature Selectionï¼‰</a>
è¿™éƒ¨åˆ†ä¸»è¦æ˜¯ä¸Šè¿°ä¸¤ç¯‡æ–‡ç« çš„æ±‡æ€»ï¼Œä»¥åŠskilearnå®˜æ–¹apiä¸­<a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.feature_selection">feature-selectç›¸å…³æ¥å£</a>çš„è¯´æ˜
<a href="https://blog.csdn.net/cymy001/article/details/79425960">sklearnåº“feature selectionç‰¹å¾é€‰æ‹©ç®—æ³•åŠAPIä½¿ç”¨</a>
<img src="https://img-blog.csdnimg.cn/7b21cd356eba434f9171a6a1161bdcfd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>

<h2 id="filterè¿‡æ»¤æ³•">Filterè¿‡æ»¤æ³•</h2>
<h3 id="æ–¹å·®è¿‡æ»¤">æ–¹å·®è¿‡æ»¤</h3>
<p>ã€€Variance Thresholdæ˜¯é€šè¿‡ç‰¹å¾æœ¬èº«æ–¹å·®æ¥ç­›é€‰ç‰¹å¾çš„ç±»ã€‚æ¯”å¦‚ä¸€ä¸ªç‰¹å¾æœ¬èº«çš„æ–¹å·®å¾ˆå°ï¼Œå°±è¡¨ç¤ºæ ·æœ¬åœ¨è¿™ä¸ªç‰¹å¾ä¸ŠåŸºæœ¬æ²¡æœ‰å·®å¼‚ï¼Œå¯èƒ½ç‰¹å¾ä¸­çš„å¤§å¤šæ•°å€¼éƒ½ä¸€æ ·ï¼Œç”šè‡³æ•´ä¸ªç‰¹å¾çš„å–å€¼éƒ½ç›¸åŒï¼Œé‚£è¿™ä¸ªç‰¹å¾å¯¹äºæ ·æœ¬åŒºåˆ†æ²¡æœ‰ä»€ä¹ˆä½œç”¨ã€‚æ‰€ä»¥æ— è®ºæ¥ä¸‹æ¥çš„ç‰¹å¾å·¥ç¨‹è¦åšä»€ä¹ˆï¼Œéƒ½è¦ä¼˜å…ˆæ¶ˆé™¤æ–¹å·®ä¸º0çš„ç‰¹å¾ã€‚VarianceThresholdæœ‰é‡è¦å‚æ•°thresholdï¼Œè¡¨ç¤ºæ–¹å·®çš„é˜ˆå€¼ï¼Œè¡¨ç¤ºèˆå¼ƒæ‰€æœ‰æ–¹å·®å°äºthresholdçš„ç‰¹å¾ï¼Œä¸å¡«é»˜è®¤ä¸º0ï¼Œå³åˆ é™¤æ‰€æœ‰çš„è®°å½•éƒ½ç›¸åŒçš„ç‰¹å¾ã€‚</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#è®¾ç½®æ–¹å·®é˜ˆå€¼ç­›é€‰
</span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">VarianceThreshold</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="c1">#è®¾ç½®æ–¹å·®è¿‡æ»¤é˜ˆå€¼ä¸º1
</span><span class="n">aa</span> <span class="o">=</span> <span class="n">selector</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">feature_frame</span><span class="p">)</span>
<span class="n">aa_name</span> <span class="o">=</span> <span class="n">selector</span><span class="p">.</span><span class="n">get_support</span><span class="p">()</span><span class="c1">#get_supportå‡½æ•°è¿”å›æ–¹å·®ï¼é˜ˆå€¼çš„å¸ƒå°”å€¼åºåˆ—
</span><span class="n">aa_select</span> <span class="o">=</span> <span class="n">feature_frame</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">aa_name</span><span class="p">]</span><span class="c1">#æ ¹æ®å¸ƒå°”å€¼åºåˆ—å–å‡ºå„ä¸ªç‰¹å¾
</span></code></pre></div></div>
<p>è¿™ä¸ªè¿‡ç¨‹å…¶å®ä¹Ÿå¯ä»¥ä¸ç”¨apiå‡½æ•°è‡ªè¡Œå®ç°ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">var</span> <span class="o">=</span> <span class="n">feature_frame</span><span class="p">.</span><span class="n">var</span><span class="p">()</span><span class="c1">#æ±‚æ¯åˆ—æ–¹å·®
</span><span class="n">var_thresh</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#è®¾ç½®é˜ˆå€¼
</span><span class="n">var_select</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="n">var</span><span class="o">&gt;</span><span class="n">var_thresh</span><span class="p">]</span><span class="c1">#æ ¹æ®æ¡ä»¶è¿”å›åºåˆ—å€¼ï¼Œå–å¤§äºé˜ˆå€¼
</span><span class="n">X</span> <span class="o">=</span> <span class="n">feature_frame</span><span class="p">[</span><span class="n">var_select</span><span class="p">.</span><span class="n">index</span><span class="p">]</span><span class="c1">#å–å‡ºç‰¹å¾
</span></code></pre></div></div>
<p>æ–¹å·®è¿‡æ»¤çš„é˜ˆå€¼thresholdæ˜¯ä¸€ä¸ªè¶…å‚ï¼Œæ ¹æ®æƒ…å†µè‡ªè¡Œè®¾ç½®ï¼Œè®¾ç½®ä¸º0å¯ä»¥å‰”é™¤å¸¸é‡ç‰¹å¾ã€‚</p>
<h3 id="ç›¸å…³æ€§è¿‡æ»¤">ç›¸å…³æ€§è¿‡æ»¤</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ä¸€èˆ¬æƒ…å†µä¸‹ç‰¹å¾å¦‚æœå’Œæ ‡ç­¾çš„ç›¸å…³æ€§æ¯”è¾ƒå¤§çš„è¯ï¼Œè¿™æ ·çš„ç‰¹å¾èƒ½å¤Ÿä¸ºæˆ‘ä»¬æä¾›å¤§é‡çš„ä¿¡æ¯ã€‚å¦‚æœç‰¹å¾ä¸æ ‡ç­¾æ— å…³ï¼Œåªä¼šç™½ç™½æµªè´¹æˆ‘ä»¬çš„ç®—åŠ›ï¼Œè¿˜å¯èƒ½ç»™æ¨¡å‹å¸¦æ¥å™ªå£°ã€‚åœ¨ sklearn ä¸­æœ‰ä¸‰ç§å¸¸ç”¨çš„æ–¹æ³•æ¥è¯„åˆ¤ç‰¹å¾å’Œæ ‡ç­¾ä¹‹é—´çš„ç›¸å…³æ€§ï¼šå¡æ–¹ã€Fæ£€éªŒå’Œäº’ä¿¡æ¯ã€‚
  æ­¤å¤–è¿˜å¯ä»¥ä»ç‰¹å¾é—´çš„ç›¸å…³æ€§è€ƒè™‘ç›¸å…³æ€§è¿‡æ»¤ï¼Œå‡è®¾ä¸¤ä¸ªç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ç‰¹åˆ«é«˜ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç‰¹å¾æ„æˆäº†å†—ä½™ä¿¡æ¯ï¼Œåªéœ€ä¿ç•™å…¶ä¸­ä¹‹ä¸€å³å¯ã€‚ - **å›å½’é—®é¢˜ï¼šf_regressionï¼ˆFæ£€éªŒå›å½’ï¼‰ , mutual_info_regressionï¼ˆäº’ä¿¡æ¯å›å½’ï¼‰**
</code></pre></div></div>

<ul>
  <li><strong>åˆ†ç±»é—®é¢˜ï¼šchi2ï¼ˆå¡æ–¹æ£€éªŒï¼‰ , f_classifï¼ˆFæ£€éªŒåˆ†ç±»ï¼‰ , mutual_info_classifï¼ˆäº’ä¿¡æ¯å›å½’ï¼‰</strong></li>
</ul>

<h4 id="å¡æ–¹è¿‡æ»¤">å¡æ–¹è¿‡æ»¤</h4>
<p>å¡æ–¹æ£€éªŒæ˜¯ä¸€ç§ç”¨é€”å¾ˆå¹¿çš„è®¡æ•°èµ„æ–™çš„å‡è®¾æ£€éªŒæ–¹æ³•ã€‚å®ƒå±äºéå‚æ•°æ£€éªŒçš„èŒƒç•´ï¼Œä¸»è¦æ˜¯æ¯”è¾ƒä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šæ ·æœ¬ç‡( æ„æˆæ¯”ï¼‰ä»¥åŠä¸¤ä¸ªåˆ†ç±»å˜é‡çš„å…³è”æ€§åˆ†æã€‚ï¼ˆ<strong>ä»…é€‚ç”¨äºåˆ†ç±»é—®é¢˜</strong>ï¼‰
å¡æ–¹éªŒè¯çš„æ€è·¯ï¼ˆ<a href="https://blog.csdn.net/michaelhan3/article/details/89636139?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E5%8D%A1%E6%96%B9%E9%AA%8C%E8%AF%81&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-89636139.nonecase&amp;spm=1018.2226.3001.4187">è¯¦æƒ…å¯ä»¥å‚è€ƒ</a>ï¼‰æ˜¯å…ˆå‡è®¾ä¸¤ä¸ªå˜é‡æ˜¯ç‹¬ç«‹æ— å…³çš„ï¼Œç”±æ­¤è®¡ç®—å‡ºä¸¤å˜é‡ç‹¬ç«‹æ— å…³æ—¶çš„åˆ†å¸ƒæƒ…å†µï¼Œå°†è¿™ä¸ªæƒ…å†µä¸çœŸå®æƒ…å†µå¯¹æ¯”ï¼Œæ ¹æ®å¡æ–¹å…¬å¼è®¡ç®—å‡ºå¡æ–¹ï¼š
<img src="https://img-blog.csdnimg.cn/2ffe29041d964c73aeaaf6c04d9dd07c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />ç„¶åé€šè¿‡æŸ¥é˜…å¡æ–¹è¡¨åˆ¤æ–­å‡è®¾æ˜¯å¦å¯é ã€‚å¡æ–¹è¡¨ä¼šæä¾›è®¡ç®—çš„å¡æ–¹å€¼å¯¹åº”çš„på€¼ï¼Œ <strong>p å€¼æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ 0.01 æˆ– 0.05 ä½œä¸ºæ˜¾è‘—æ€§æ°´å¹³</strong>ï¼Œå³på€¼åˆ¤æ–­çš„è¾¹ç•Œï¼Œpå€¼å°äº0.01æˆ–0.05ä¸ºç›¸å…³ç‰¹å¾ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">chi2</span>
 
<span class="c1">#ä½¿ç”¨é€‰æ‹©å™¨çš„SelectKBestå‡½æ•°ï¼Œä½¿ç”¨chi2æ¨¡å‹ï¼ˆå¡æ–¹éªŒè¯ï¼‰ä¿ç•™å…³è”æœ€å¤§çš„300ä¸ªç‰¹å¾
</span><span class="n">X_fschi</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">chi2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">300</span><span class="p">).</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_fsvar</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c1">#é™¤äº†é€‰æ‹©å‰Kä¸ªç‰¹å¾ï¼Œä¹Ÿå¯ä»¥è®¾ç½®é€‰æ‹©ç™¾åˆ†æ¯”ä¾‹SelectPercentile()
#X_new = SelectPercentile(chi2, percentile=10).fit_transform(X, y)
</span></code></pre></div></div>
<p>chi2å‡½æ•°ä¹Ÿå¯ç›´æ¥è¿”å›ç‰¹å¾ä¸ç›®æ ‡ä¹‹é—´çš„å¡æ–¹å€¼å’Œå¯¹åº”çš„på€¼</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">chi</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">(</span><span class="n">X_fsvar</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>
<p>æ ¹æ®å„ä¸ªç‰¹å¾è®¡ç®—å‡ºçš„på€¼ï¼Œä»¥0.05æˆ–è€…0.1ä¸ºé˜ˆå€¼è¿‡æ»¤ç›¸åº”çš„ç‰¹å¾</p>

<h4 id="fæ£€éªŒ">Fæ£€éªŒ</h4>
<p>Fæ£€éªŒï¼Œåˆç§°ANOVAï¼Œæ–¹å·®é½æ€§æ£€éªŒï¼Œæ˜¯ç”¨æ¥æ•æ‰æ¯ä¸ªç‰¹å¾ä¸æ ‡ç­¾ä¹‹é—´çš„çº¿æ€§å…³ç³»çš„è¿‡æ»¤æ–¹æ³•ã€‚Få€¼è®¡ç®—å…¬å¼ï¼š
<img src="https://img-blog.csdnimg.cn/ee885e8b6e6c4131aaceed6eabdff697.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>

<p><a href="https://blog.csdn.net/olizxq/article/details/99177262?spm=1001.2101.3001.6650.4&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-4.opensearchhbase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-4.opensearchhbase">Fæ£€éªŒçš„å…·ä½“åŸç†</a>
å’Œå¡æ–¹è¿‡æ»¤ä¸€æ ·ï¼ŒFå€¼è®¡ç®—å‡ºåŒæ ·è¦æŸ¥è¯¢Fåˆ†å¸ƒè¡¨è·å–på€¼ï¼Œæˆ‘ä»¬å¸Œæœ›é€‰<strong>å–på€¼å°äº 0.05 æˆ– 0.01 çš„ç‰¹å¾</strong>ï¼Œè¿™äº›ç‰¹å¾ä¸æ ‡ç­¾æ—¶æ˜¾è‘—çº¿æ€§ç›¸å…³çš„ï¼Œè€Œpå€¼å¤§äº0.05æˆ–0.01çš„ç‰¹å¾åˆ™è¢«æˆ‘ä»¬è®¤ä¸ºæ˜¯å’Œæ ‡ç­¾æ²¡æœ‰æ˜¾è‘—çº¿æ€§å…³ç³»çš„ç‰¹å¾ï¼Œåº”è¯¥è¢«åˆ é™¤ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">f_classif</span>
<span class="n">F</span><span class="p">,</span> <span class="n">pvalues_f</span> <span class="o">=</span> <span class="n">f_classif</span><span class="p">(</span><span class="n">X_fsvar</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="äº’ä¿¡æ¯">äº’ä¿¡æ¯</h4>
<p>äº’ä¿¡æ¯æ³•æ˜¯ç”¨æ¥æ•æ‰æ¯ä¸ªç‰¹å¾ä¸æ ‡ç­¾ä¹‹é—´çš„ä»»æ„å…³ç³»ï¼ˆåŒ…æ‹¬çº¿æ€§å’Œéçº¿æ€§å…³ç³»ï¼‰çš„è¿‡æ»¤æ–¹æ³•ã€‚äº’ä¿¡æ¯æ³•æ¯”Fæ£€éªŒæ›´åŠ å¼ºå¤§ï¼ŒFæ£€éªŒåªèƒ½å¤Ÿæ‰¾å‡ºçº¿æ€§å…³ç³»ï¼Œè€Œäº’ä¿¡æ¯æ³•å¯ä»¥æ‰¾å‡ºä»»æ„å…³ç³»ã€‚äº’ä¿¡æ¯æ³•ä¸è¿”å› p å€¼æˆ– F å€¼ç±»ä¼¼çš„ç»Ÿè®¡é‡ï¼Œ<strong>å®ƒè¿”å›â€œæ¯ä¸ªç‰¹å¾ä¸ç›®æ ‡ä¹‹é—´çš„äº’ä¿¡æ¯é‡çš„ä¼°è®¡â€ï¼Œè¿™ä¸ªä¼°è®¡é‡åœ¨[0,1]ä¹‹é—´å–å€¼ï¼Œä¸º0åˆ™è¡¨ç¤ºä¸¤ä¸ªå˜é‡ç‹¬ç«‹ï¼Œä¸º1åˆ™è¡¨ç¤ºä¸¤ä¸ªå˜é‡å®Œå…¨ç›¸å…³ã€‚</strong>
<img src="https://img-blog.csdnimg.cn/cd28a92b252945f48cfb58b514ec51f9.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">mutual_info_classif</span>
<span class="n">mutual_info</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">discrete_features</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p>è¿”å›å€¼ä¸ºXä¸­æ¯ä¸ªç‰¹å¾ä¸ç›®æ ‡yçš„äº’ä¿¡æ¯ä¼°è®¡å€¼ã€‚</p>

<p><strong>ä½¿ç”¨äº’ä¿¡æ¯è®¡ç®—ç‰¹å¾ä¸ç›®æ ‡é—´çš„å…³è”æ€§ä¸ä½¿ç”¨ç›¸å…³ç³»æ•°ï¼ˆçš®å°”é€Šã€æ–¯ä¼¯å°”æ›¼ã€è‚¯å¾·å°”ï¼‰å¾—å‡ºçš„ç»“è®ºå…·æœ‰å¾ˆé«˜çš„ä¸€è‡´æ€§ã€‚</strong>
pandasä¸­çš„dataframeå¯ä»¥ç›´æ¥è®¡ç®—å„åˆ—ä¹‹é—´çš„ç›¸å…³ç³»æ•°çŸ©é˜µï¼š
ä¸‹è¾¹çš„ä»£ç çš„æ€è·¯æ˜¯å°†ç›®æ ‡åºåˆ—ä¸ç‰¹å¾çŸ©é˜µä¸­æ¯ä¸€åˆ—ç»„æˆæ–°çš„datafarmeè®¡ç®—ç›¸å…³ç³»æ•°çŸ©é˜µã€‚</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#è®¡ç®—ç‰¹å¾ä¸åˆ†å­æ´»æ€§é—´çš„çš®å°”é€Šç›¸å…³ç³»æ•°ï¼Œå–ç»å¯¹å€¼
</span><span class="n">pesrson_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">spearman_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">kendall_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">columns</span><span class="p">):</span>
     <span class="n">temp_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pic50</span><span class="p">)</span>
     <span class="n">temp_series</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>
     <span class="n">temp_frame</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">temp_series</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="n">temp_series</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
     <span class="n">pesrson_martrix</span> <span class="o">=</span> <span class="n">temp_frame</span><span class="p">.</span><span class="n">corr</span><span class="p">()</span>
     <span class="n">spearman_martrix</span> <span class="o">=</span> <span class="n">temp_frame</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span><span class="s">'spearman'</span><span class="p">)</span> 
     <span class="n">kendall_martrix</span> <span class="o">=</span> <span class="n">temp_frame</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span><span class="s">'kendall'</span><span class="p">)</span>
     <span class="n">pesrson_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pesrson_martrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
     <span class="n">spearman_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">spearman_martrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
     <span class="n">kendall_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">kendall_martrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  
<span class="n">pesrson</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pesrson_list</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">spearman</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">spearman_list</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">kendall</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kendall_list</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></div>
<p>å®é™…ä¸­ä¹Ÿå¯ä»¥ä¹‹é—´å°†ç›®å½•åºåˆ—æ’å…¥ç‰¹å¾çŸ©é˜µæœ€åä¸€åˆ—ï¼Œè®¡ç®—ç›¸å…³ç³»æ•°çŸ©é˜µï¼Œç”±äºç›¸å…³ç³»æ•°çŸ©é˜µåæ˜ çŸ©é˜µå„ä¸ªåˆ—ä¹‹é—´çš„ç›¸å…³ç³»æ•°ï¼Œåˆ™ç›¸å…³ç³»æ•°çŸ©é˜µæœ€åä¸€åˆ—ç¬¬ä¸€è¡Œè‡³å€’æ•°ç¬¬äºŒè¡Œå³å¯¹åº”ç¬¬ä¸€ä¸ªç‰¹å¾åˆ°æœ€åä¸€ä¸ªç‰¹å¾ä¸ç›®æ ‡å˜é‡é—´ç›¸å…³ç³»æ•°ã€‚</p>

<h3 id="ç°è‰²å…³è”åº¦åˆ†ægra">ç°è‰²å…³è”åº¦åˆ†æï¼ˆGRAï¼‰</h3>
<p><a href="https://blog.csdn.net/edogawachia/article/details/85330067">ç°è‰²å…³è”åº¦è®¡ç®—æ–¹æ³•</a>
<img src="https://img-blog.csdnimg.cn/fbec31f5c4b24e63b6b40bc529d4255a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />ä»£ç ç¤ºä¾‹ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#è®¡ç®—ç‰¹å¾ä¸åˆ†å­æ´»æ€§é—´çš„ç°è‰²å…³è”åº¦
</span><span class="n">æ•°æ®å½’ä¸€åŒ–</span>
<span class="n">normal_pic50</span> <span class="o">=</span> <span class="p">(</span><span class="n">pic50</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">pic50</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">pic50</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">pic50</span><span class="p">))</span>  <span class="c1">#pIC50ç»“æœå½’ä¸€åŒ–
</span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">normal_X</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>  
<span class="n">normal_X</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">index</span>
<span class="n">normal_X</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">columns</span>
<span class="n">refer_seq</span> <span class="o">=</span> <span class="n">normal_pic50</span> <span class="c1">#è®¾ç½®åˆ†å­æ´»æ€§ä¸ºå‚è€ƒåºåˆ—ï¼Œç‰¹å¾çŸ©é˜µæ¯åˆ—ä¸ºæ¯”è¾ƒåºåˆ—
</span><span class="n">diff_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">normal_X</span><span class="p">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="c1">#æ¯”è¾ƒåºåˆ—ä¸å‚è€ƒåºåˆ—ç›¸å‡
</span>    <span class="n">diff_col</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">-</span> <span class="n">refer_seq</span><span class="p">)</span>
    <span class="n">diff_col</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">feature</span>
    <span class="n">diff_matrix</span> <span class="o">=</span> <span class="n">diff_matrix</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_col</span><span class="p">)</span> <span class="c1">#è¿™é‡Œappendæ˜¯æŒ‰è¡Œæ·»åŠ çš„ï¼Œå› æ­¤åè¾¹éœ€è¦è½¬ç½®ä¸€ä¸‹
</span><span class="n">diff_matrix</span> <span class="o">=</span> <span class="n">diff_matrix</span><span class="p">.</span><span class="n">T</span>
<span class="c1">#æ±‚æœ€å¤§å·®å’Œæœ€å°å·®
</span><span class="n">mmax</span> <span class="o">=</span> <span class="n">diff_matrix</span><span class="p">.</span><span class="nb">abs</span><span class="p">().</span><span class="nb">max</span><span class="p">().</span><span class="nb">max</span><span class="p">()</span>
<span class="n">mmin</span> <span class="o">=</span> <span class="n">diff_matrix</span><span class="p">.</span><span class="nb">abs</span><span class="p">().</span><span class="nb">min</span><span class="p">().</span><span class="nb">min</span><span class="p">()</span>
<span class="n">rho</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1">#è®¾ç½®åˆ†è¾¨ç³»æ•°ä¸º0.5
#æ±‚å…³è”åº¦
</span><span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">mmin</span><span class="o">+</span><span class="n">rho</span><span class="o">*</span><span class="n">mmax</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">diff_matrix</span><span class="p">)</span><span class="o">+</span><span class="n">rho</span><span class="o">*</span><span class="n">mmax</span><span class="p">))</span>
<span class="n">grey_corr</span><span class="o">=</span><span class="n">r</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_matrix</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">grey_sort</span><span class="o">=</span><span class="n">grey_corr</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1">##å¯è§†åŒ–ç°è‰²å…³è”åº¦æ’å
</span><span class="n">grey_select</span> <span class="o">=</span> <span class="n">grey_sort</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">pesrson_select</span><span class="p">)]</span>

<span class="c1">##ä¸¤ç§å…³è”åº¦çš„äº¤å‰
</span><span class="n">common_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">grey_select</span><span class="p">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">pesrson_select</span><span class="p">.</span><span class="n">index</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å…¬å…±å˜é‡ä¸ºï¼š"</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_test</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">grey_select</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">grey_select</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s">'h'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"ç‰¹å¾ä¸åˆ†å­æ´»æ€§ä¹‹é—´çš„ç°è‰²å…³è”åº¦æ’åº"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="wrapperåŒ…è£…æ³•">WrapperåŒ…è£…æ³•</h2>
<p><strong>åŒ…è£…æ³•å°†ç‰¹å¾åŒ…è£…è¿›æ¨¡å‹é€šè¿‡è¯„ä¼°æ¨¡å‹æ•ˆæœï¼Œåˆ¤æ–­ç‰¹å¾çš„å»ç•™</strong>ã€‚åœ¨åˆå§‹ç‰¹å¾é›†ä¸Šè®­ç»ƒè¯„ä¼°å™¨ï¼Œå¹¶ä¸”é€šè¿‡coef_å±æ€§æˆ–é€šè¿‡feature_importances_å±æ€§è·å¾—æ¯ä¸ªç‰¹å¾çš„é‡è¦æ€§ã€‚ç„¶åï¼Œä»å½“å‰çš„ä¸€ç»„ç‰¹å¾ä¸­ä¿®å‰ªæœ€ä¸é‡è¦çš„ç‰¹å¾ã€‚åœ¨ä¿®å‰ªçš„é›†åˆä¸Šé€’å½’åœ°é‡å¤è¯¥è¿‡ç¨‹ï¼Œç›´åˆ°æœ€ç»ˆåˆ°è¾¾æ‰€éœ€æ•°é‡çš„è¦é€‰æ‹©çš„ç‰¹å¾ã€‚
<img src="https://img-blog.csdnimg.cn/f051141b9ad44b8fa7a52f2610ce21c4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />åŒ…è£…æ³•æœ€å…¸å‹çš„æ–¹æ³•ä¸ºé€’å½’ç‰¹å¾æ¶ˆé™¤æ³•Recursive feature elimination (RFE)
ä¸»è¦æ€æƒ³æ˜¯åå¤çš„æ„å»ºæ¨¡å‹ï¼ˆå¦‚SVMæˆ–è€…å›å½’æ¨¡å‹ï¼‰ç„¶åé€‰å‡ºæœ€å·®çš„ï¼ˆæˆ–è€…æœ€å¥½çš„ï¼‰çš„ç‰¹å¾ï¼ˆå¯ä»¥æ ¹æ®ç³»æ•°æ¥é€‰ï¼‰ï¼ŒæŠŠé€‰å‡ºæ¥çš„ç‰¹å¾æ”¾åˆ°ä¸€è¾¹ï¼Œç„¶ååœ¨å‰©ä½™çš„ç‰¹å¾ä¸Šé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰ç‰¹å¾éƒ½éå†äº†ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ç‰¹å¾è¢«æ¶ˆé™¤çš„æ¬¡åºå°±æ˜¯ç‰¹å¾çš„æ’åºã€‚å› æ­¤ï¼Œè¿™æ˜¯ä¸€ç§å¯»æ‰¾æœ€ä¼˜ç‰¹å¾å­é›†çš„è´ªå¿ƒç®—æ³•ã€‚</p>

<p>RFEçš„ç¨³å®šæ€§å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºåœ¨è¿­ä»£çš„æ—¶å€™åº•å±‚ç”¨å“ªç§æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚RFEé‡‡ç”¨çš„æ™®é€šçš„å›å½’ï¼Œæ²¡æœ‰ç»è¿‡æ­£åˆ™åŒ–çš„å›å½’æ˜¯ä¸ç¨³å®šçš„ï¼Œé‚£ä¹ˆRFEå°±æ˜¯ä¸ç¨³å®šçš„ï¼›å‡å¦‚é‡‡ç”¨çš„æ˜¯Ridgeï¼Œè€Œç”¨Ridgeæ­£åˆ™åŒ–çš„å›å½’æ˜¯ç¨³å®šçš„ï¼Œé‚£ä¹ˆRFEå°±æ˜¯ç¨³å®šçš„ã€‚
sklearn.feature_selection.RFE
<img src="https://img-blog.csdnimg.cn/05a33c4c72b54b8da55cc29a91490cec.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />RFEç±»ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„å±æ€§ï¼Œ.support_ï¼šè¿”å›æ‰€æœ‰çš„ç‰¹å¾çš„æ˜¯å¦æœ€åè¢«é€‰ä¸­çš„å¸ƒå°”çŸ©é˜µï¼Œä»¥åŠ.ranking_è¿”å›ç‰¹å¾çš„æŒ‰æ•°æ¬¡è¿­ä»£ä¸­ç»¼åˆé‡è¦æ€§çš„æ’åã€‚
<img src="https://img-blog.csdnimg.cn/0ea728da402f4c66bb8835733292636a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>

<p>skileanrè¿˜æœ‰ä¸€ä¸ªç±»feature_selection.RFECVä¼šåœ¨äº¤å‰éªŒè¯å¾ªç¯ä¸­æ‰§è¡ŒRFEä»¥æ‰¾åˆ°æœ€ä½³æ•°é‡çš„ç‰¹å¾ï¼Œå¢åŠ å‚æ•°cvï¼Œå…¶ä»–ç”¨æ³•éƒ½å’ŒRFEä¸€æ¨¡ä¸€æ ·ã€‚</p>

<h2 id="embeddedåµŒå…¥æ³•">EmbeddedåµŒå…¥æ³•</h2>
<p><strong>åŒ…è£…æ³•å°†ç‰¹å¾æ‰“åŒ…ä¸æ–­åˆ›å»ºæ–°æ¨¡å‹æµ‹è¯•ç‰¹å¾çš„æœ‰æ•ˆæ€§</strong>ï¼Œè€ŒåµŒå…¥æ³•åˆ™æ˜¯å°†ç‰¹å¾éƒ½åµŒå…¥åˆ°ç®—æ³•æµç¨‹ä¸­ï¼Œç±»ä¼¼éšæœºæ£®æ—å’Œå†³ç­–æ ‘æ¨¡å‹åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­æ ¹æ®ä¿¡æ¯å¢ç›Šå¯¹ç‰¹å¾é‡è¦æ€§èµ‹äºˆæƒé‡ï¼Œç‰¹å¾é€‰æ‹©ä¸æ¨¡å‹ç”ŸæˆåŒæ­¥è¿›è¡Œï¼Œè€Œ<strong>ä¸å¿…é‡å¤åˆ›å»ºæ¨¡å‹</strong>æµ‹è¯•ç‰¹å¾çš„é‡è¦æ€§ã€‚
<img src="https://img-blog.csdnimg.cn/6d3b2d1f06f446478279b343aa717d9e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>

<h3 id="ä½¿ç”¨selectfrommodel-é€‰å–ç‰¹å¾feature-selection-using-selectfrommodel">ä½¿ç”¨SelectFromModel é€‰å–ç‰¹å¾ï¼ˆFeature selection using SelectFromModelï¼‰</h3>

<p><img src="https://img-blog.csdnimg.cn/cd065163f70c4610ad58f0e068610b07.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />
ç¤ºä¾‹1 éšæœºæ£®æ—æ¨¡å‹ç»˜åˆ¶å­¦ä¹ æ›²çº¿ç¡®å®šç‰¹å¾é‡è¦æ€§é˜ˆå€¼</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectFromModel</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span> <span class="k">as</span> <span class="n">RFC</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span>
<span class="n">RFC_</span> <span class="o">=</span> <span class="n">RFC</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">X_embedded</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#æ¨¡å‹çš„ç»´åº¦æ˜æ˜¾è¢«é™ä½äº†
#ç”»å­¦ä¹ æ›²çº¿æ¥æ‰¾æœ€ä½³é˜ˆå€¼
</span> 
<span class="n">RFC_</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">).</span><span class="n">feature_importances_</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="n">RFC_</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">).</span><span class="n">feature_importances_</span><span class="p">).</span><span class="nb">max</span><span class="p">(),</span><span class="mi">20</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">threshold</span><span class="p">:</span>
<span class="n">X_embedded</span> <span class="o">=</span> <span class="n">SelectFromModel</span><span class="p">(</span><span class="n">RFC_</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="n">i</span><span class="p">).</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">once</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">RFC_</span><span class="p">,</span><span class="n">X_embedded</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
<span class="n">score</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">once</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span><span class="n">score</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">X_embedded</span> <span class="o">=</span> <span class="n">SelectFromModel</span><span class="p">(</span><span class="n">RFC_</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.00067</span><span class="p">).</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">X_embedded</span><span class="p">.</span><span class="n">shape</span>
<span class="k">print</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">RFC_</span><span class="p">,</span><span class="n">X_embedded</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">).</span><span class="n">mean</span><span class="p">())</span>
</code></pre></div></div>

<p>ç¤ºä¾‹2ï¼šåŸºäºL1çš„ç‰¹å¾é€‰å–</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectFromModel</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span>

<span class="n">lsvc</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s">"l1"</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SelectFromModel</span><span class="p">(</span><span class="n">lsvc</span><span class="p">,</span> <span class="n">prefit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_new</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>
<h3 id="åŸºäºæ ‘æ¨¡å‹ç‰¹å¾ç­›é€‰">åŸºäºæ ‘æ¨¡å‹ç‰¹å¾ç­›é€‰</h3>
<p>xgboostå’Œlightgbmç­‰é›†æˆå­¦ä¹ æ ‘æ¨¡å‹å¯ä»¥åœ¨è®­ç»ƒä¸­è®°å½•ç‰¹å¾çš„é‡è¦æ€§ï¼Œè¿™äº›é‡è¦æ€§çš„è®¡ç®—æ–¹æ³•ä¸»è¦æœ‰ä¸‰ç§ï¼š
â€˜weightâ€™ - ç‰¹å¾åœ¨æ‰€æœ‰æ ‘ä¸Šè¢«ä½¿ç”¨çš„æ¬¡æ•°
â€˜gainâ€™ - æ‰€æœ‰ä½¿ç”¨è¯¥ç‰¹å¾çš„æ ‘çš„å¹³å‡ä¿¡æ¯å¢ç›Š
â€˜coverâ€™ - åœ¨æ ‘ä¸Šä½¿ç”¨è¯¥ç‰¹å¾æ—¶çš„å¹³å‡è¦†ç›–ç‡
ä»¥lightgbmä¸ºä¾‹ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="n">lgbm</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">plot_importance</span>
<span class="n">lgbm_reg</span> <span class="o">=</span> <span class="n">lgbm</span><span class="p">.</span><span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="s">'regression'</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">num_leaves</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">min_child_samples</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">colsample_bytree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">reg_alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">reg_lambda</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lgbm_reg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="c1">#é€‰æ‹©æœ€é‡è¦çš„20ä¸ªç‰¹å¾ï¼Œç»˜åˆ¶ä»–ä»¬çš„é‡è¦æ€§æ’åºå›¾
</span><span class="n">lgbm</span><span class="p">.</span><span class="n">plot_importance</span><span class="p">(</span><span class="n">lgbm_reg</span><span class="p">,</span> <span class="n">max_num_features</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1">##ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨è‡ªå¸¦çš„plot_importanceå‡½æ•°ï¼Œæ‰‹åŠ¨è·å–ç‰¹å¾é‡è¦æ€§å’Œç‰¹å¾åï¼Œç„¶åç»˜å›¾
</span><span class="n">feature_weight</span> <span class="o">=</span> <span class="n">lgbm_reg</span><span class="p">.</span><span class="n">feature_importances_</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="n">lgbm_reg</span><span class="p">.</span><span class="n">feature_name_</span>
<span class="n">feature_sort</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">feature_weight</span> <span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">feature_name</span><span class="p">)</span>
<span class="n">feature_sort</span> <span class="o">=</span> <span class="n">feature_sort</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">feature_sort</span><span class="p">.</span><span class="n">values</span><span class="p">,</span><span class="n">feature_sort</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s">'h'</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="https://img-blog.csdnimg.cn/addd61f6e88e40fb80d929ef722a35b8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />
<img src="https://img-blog.csdnimg.cn/d216292cd1df427f91086e87af8a3b12.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />
ä¸¤ä¸ªå›¾æ˜¯ä¸€è‡´çš„ã€‚</p>

<h1 id="é¢˜ç›®åº”ç”¨">é¢˜ç›®åº”ç”¨</h1>
<p>èƒŒæ™¯é¢˜ç›®æ˜¯é¢„æµ‹å›å½’ç±»é—®é¢˜ï¼Œç»“åˆä¸Šè¿°ç‰¹å¾ç­›é€‰çš„åŸºæœ¬æ–¹æ³•ï¼Œé€‰æ‹©æ–¹å·®è¿‡æ»¤ç»“åˆç›¸å…³æ€§è¿‡æ»¤ç„¶åä½¿ç”¨åŒ…è£…æ³•ä¸­çš„é€’å½’ç‰¹å¾æ¶ˆé™¤æ³•RFEç­›é€‰å‡º20ä¸ªç‰¹å¾ï¼Œä½¿ç”¨lightGBMç»˜åˆ¶ç‰¹å¾é‡è¦æ€§</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
</span><span class="s">"""
Created on Sat Oct 23 14:40:01 2021

@author: Flower unbeaten
"""</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> <span class="c1">#æ•°æ®å¤„ç†
</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> <span class="c1">#dataFrame,Seriesç­‰æ•°æ®ç»“æ„
</span><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'font.family'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'SimHei'</span> <span class="c1">#è®¾ç½®ç»˜å›¾çš„ä¸­æ–‡æ˜¾
</span><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'axes.unicode_minus'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span><span class="c1">#matplotlibç»˜å›¾å‡†å¤‡ï¼Œä¸­æ–‡æ˜¾ç¤ºç­‰
</span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>   <span class="c1">#å¯¼å…¥seabornç»˜å›¾åº“
</span><span class="n">sns</span><span class="p">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'darkgrid'</span><span class="p">)</span> <span class="c1">#è®¾ç½®seabornç»˜å›¾é£æ ¼ä¸ºæš—è‰²ç½‘ç»œ
</span><span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="s">"simhei"</span><span class="p">)</span><span class="c1">#snsé‡åˆ°æ ‡ç­¾éœ€è¦æ±‰å­—çš„å¯ä»¥åœ¨ç»˜å›¾å‰åŠ ä¸Šè¿™å¥ï¼Œä¸pltç±»ä¼¼
</span>
<span class="c1">##import data
</span><span class="n">feature_path</span> <span class="o">=</span> <span class="s">"../data/Molecular_Descriptor.xlsx"</span>
<span class="n">c50_path</span> <span class="o">=</span> <span class="s">"../data/ERÎ±_activity.xlsx"</span>
<span class="n">admet_path</span> <span class="o">=</span> <span class="s">"../data/ADMET.xlsx"</span>
<span class="n">feature_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">feature_path</span><span class="p">,</span><span class="n">sheet_name</span> <span class="o">=</span> <span class="s">'training'</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s">'SMILES'</span><span class="p">)</span> <span class="c1">#ä½¿ç”¨pdè¯»å–excelï¼Œindex_colè®¾ç½®ä¸ºSMILES
</span><span class="n">feature_test_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">feature_path</span><span class="p">,</span><span class="n">sheet_name</span> <span class="o">=</span> <span class="s">'test'</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s">'SMILES'</span><span class="p">)</span>
<span class="n">c50_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">c50_path</span><span class="p">,</span><span class="n">sheet_name</span> <span class="o">=</span> <span class="s">'training'</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s">'SMILES'</span><span class="p">)</span> 
<span class="n">c50_frame</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s">'IC50_nM'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1">#åˆ æ‰IC50_nMæ‰€åœ¨åˆ—ï¼Œinplaceä¸ºtrueä»£è¡¨åœ¨åŸæ¥dataframeé›†æˆä¸Šåˆ é™¤ï¼Œå¦‚æœä¸ºfalseåˆ™ä¼šåˆ›å»ºæ–°çš„dataframeå¯¹è±¡å¹¶åˆ æ‰æ‰€åœ¨åˆ—
</span><span class="n">pic50</span> <span class="o">=</span> <span class="n">c50_frame</span><span class="p">[</span><span class="s">'pIC50'</span><span class="p">]</span> <span class="c1">#é€‰ä¸­æŸåˆ—ï¼Œå°†dataframeè½¬series
</span>
<span class="c1">##æ–¹å·®ç­›é€‰
</span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">VarianceThreshold</span>
<span class="n">var_selector</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="c1">#è®¾ç½®æ–¹å·®è¿‡æ»¤é˜ˆå€¼ä¸º1
</span><span class="n">var_selector</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">feature_frame</span><span class="p">)</span>
<span class="n">is_select</span> <span class="o">=</span> <span class="n">var_selector</span><span class="p">.</span><span class="n">get_support</span><span class="p">()</span><span class="c1">#get_supportå‡½æ•°è¿”å›æ–¹å·®ï¼é˜ˆå€¼çš„å¸ƒå°”å€¼åºåˆ—
</span><span class="n">var_feature</span> <span class="o">=</span> <span class="n">feature_frame</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">is_select</span><span class="p">]</span><span class="c1">#æ ¹æ®å¸ƒå°”å€¼åºåˆ—å–å‡ºå„ä¸ªç‰¹å¾æ‰€åœ¨åˆ—
</span>
<span class="c1">##ç›¸å…³æ€§ç­›é€‰
</span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">mutual_info_regression</span>
<span class="n">mutualInfo</span> <span class="o">=</span> <span class="n">mutual_info_regression</span><span class="p">(</span><span class="n">var_feature</span><span class="p">,</span> <span class="n">pic50</span><span class="p">,</span> <span class="n">discrete_features</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">mutualInfo_select</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">mutualInfo</span> <span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">var_feature</span><span class="p">.</span><span class="n">columns</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">append_frame</span> <span class="o">=</span> <span class="n">var_feature</span><span class="c1">#å…ˆå¤åˆ¶dataFrame
</span><span class="n">append_frame</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">var_feature</span><span class="p">.</span><span class="n">columns</span><span class="p">),</span><span class="n">pic50</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="n">pic50</span><span class="p">.</span><span class="n">values</span><span class="p">)</span><span class="c1">#å†æ·»åŠ ä¸€åˆ—
</span><span class="n">corr</span> <span class="o">=</span> <span class="n">append_frame</span><span class="p">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">corr_series</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">corr</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">corr_sort</span> <span class="o">=</span> <span class="n">corr_series</span><span class="p">.</span><span class="nb">abs</span><span class="p">().</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">var_feature</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'pIC50'</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">mutualInfo_select</span><span class="p">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">40</span><span class="p">],</span> <span class="n">mutualInfo_select</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">40</span><span class="p">],</span> <span class="n">orient</span><span class="o">=</span><span class="s">'h'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"åŸºäºäº’ä¿¡æ¯çš„ç›¸å…³æ€§ç­›é€‰"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">corr_sort</span><span class="p">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">40</span><span class="p">],</span> <span class="n">corr_sort</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">40</span><span class="p">],</span> <span class="n">orient</span><span class="o">=</span><span class="s">'h'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"åŸºäºç›¸å…³ç³»æ•°çš„ç›¸å…³æ€§ç­›é€‰"</span><span class="p">)</span>

<span class="c1">##é€’å½’ç‰¹å¾æ¶ˆé™¤æ³•
</span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">RFE</span>
<span class="c1">#ightGBMæ¨¡å‹è·å–ç‰¹å¾é‡è¦æ€§
</span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="n">lgbm</span>
<span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">plot_importance</span>
<span class="n">lgbm_reg</span> <span class="o">=</span> <span class="n">lgbm</span><span class="p">.</span><span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="s">'regression'</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">num_leaves</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">min_child_samples</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">colsample_bytree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">reg_alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">reg_lambda</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wapper</span> <span class="o">=</span> <span class="n">RFE</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">lgbm_reg</span><span class="p">,</span> <span class="n">n_features_to_select</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">wapper</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">var_feature</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">var_feature</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">is_select</span> <span class="o">=</span> <span class="n">wapper</span><span class="p">.</span><span class="n">support_</span>
<span class="n">wapper_feature</span> <span class="o">=</span> <span class="n">var_feature</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">is_select</span><span class="p">]</span><span class="c1">#æ ¹æ®å¸ƒå°”å€¼åºåˆ—å–å‡ºå„ä¸ªç‰¹å¾æ‰€åœ¨åˆ—
</span>
<span class="c1">##è®­ç»ƒé›†åˆ’åˆ†,ä¸‰ä¸ƒåˆ†ï¼Œéšæœºæ•°çŠ¶æ€107
</span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 
<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">wapper_feature</span><span class="p">,</span> <span class="n">pic50</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">107</span><span class="p">)</span>

<span class="c1">##å›å½’æ¨¡å‹è¯„ä»·
</span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">explained_variance_score</span>
<span class="n">model_index_function</span> <span class="o">=</span> <span class="p">[</span><span class="n">explained_variance_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">reg_score</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span><span class="n">X_test</span> <span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">y_pre</span> <span class="o">=</span> <span class="n">regressor</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">tmp_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">model_index_function</span><span class="p">:</span>
        <span class="n">tmp_score</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pre</span><span class="p">)</span>
        <span class="n">tmp_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_score</span><span class="p">)</span>
    <span class="n">model_score</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tmp_list</span><span class="p">)</span> 
    <span class="c1"># ç”»å‡ºåŸå§‹å€¼çš„æ›²çº¿
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">y_test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'real'</span><span class="p">)</span>
    <span class="c1"># ç”»å‡ºå„ä¸ªæ¨¡å‹çš„é¢„æµ‹çº¿
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">y_pre</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'cyan'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'lightgbm'</span><span class="p">)</span>       
    <span class="k">return</span> <span class="n">model_score</span>

<span class="n">lgbm_reg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">model_score</span> <span class="o">=</span> <span class="n">reg_score</span><span class="p">(</span><span class="n">lgbm_reg</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">lgbm</span><span class="p">.</span><span class="n">plot_importance</span><span class="p">(</span><span class="n">lgbm_reg</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"lgbmæ¨¡å‹ç‰¹å¾è´¡çŒ®æ’åº"</span><span class="p">)</span>

<span class="c1">##ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨è‡ªå¸¦çš„plot_importanceå‡½æ•°
</span><span class="n">feature_weight</span> <span class="o">=</span> <span class="n">lgbm_reg</span><span class="p">.</span><span class="n">feature_importances_</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="n">lgbm_reg</span><span class="p">.</span><span class="n">feature_name_</span>
<span class="n">feature_sort</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">feature_weight</span> <span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">feature_name</span><span class="p">)</span>
<span class="n">feature_sort</span> <span class="o">=</span> <span class="n">feature_sort</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">feature_sort</span><span class="p">.</span><span class="n">values</span><span class="p">,</span><span class="n">feature_sort</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s">'h'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"lgbmæ¨¡å‹ç‰¹å¾è´¡çŒ®æ’åº"</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="å›å½’æ¨¡å‹çš„è¯„ä»·æŒ‡æ ‡">å›å½’æ¨¡å‹çš„è¯„ä»·æŒ‡æ ‡</h1>
<p><a href="https://blog.csdn.net/skullFang/article/details/79107127?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-2.opensearchhbase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-2.opensearchhbase">å›å½’æ¨¡å‹è¯„ä»·æŒ‡æ ‡</a></p>
<h2 id="rmseå‡æ–¹æ ¹è¯¯å·®">RMSEï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼‰</h2>
<h2 id="maeå¹³å‡ç»å¯¹è¯¯å·®">MAEï¼ˆå¹³å‡ç»å¯¹è¯¯å·®ï¼‰</h2>
<h2 id="r2å†³å®šç³»æ•°">R2ï¼ˆå†³å®šç³»æ•°ï¼‰</h2>
<p><img src="https://img-blog.csdnimg.cn/9fc1953e484d45e18007c8bb329396f2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />
  <strong>è¶Šæ¥è¿‘1ï¼Œè¡¨æ˜æ–¹ç¨‹çš„å˜é‡å¯¹yçš„è§£é‡Šèƒ½åŠ›è¶Šå¼ºï¼Œè¿™ä¸ªæ¨¡å‹å¯¹æ•°æ®æ‹Ÿåˆçš„ä¹Ÿè¾ƒå¥½</strong></p>

<p>è¶Šæ¥è¿‘0ï¼Œè¡¨æ˜æ¨¡å‹æ‹Ÿåˆçš„è¶Šå·®</p>

<p><strong>ç»éªŒå€¼ï¼š&gt;0.4ï¼Œ æ‹Ÿåˆæ•ˆæœå¥½</strong></p>

<p><img src="https://img-blog.csdnimg.cn/40764b73ef4546e08f94926161fbbcea.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6Iq45YWu,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>

<h2 id="evè§£é‡Šæ–¹å·®">EV(è§£é‡Šæ–¹å·®)</h2>
<p><img src="https://img-blog.csdnimg.cn/4ba2e824008a40699dad0e185846a31b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />å¯è§£é‡Šæ–¹å·®æŒ‡æ ‡è¡¡é‡çš„æ˜¯æ‰€æœ‰é¢„æµ‹å€¼å’Œæ ·æœ¬ä¹‹é—´çš„å·®çš„åˆ†æ•£ç¨‹åº¦ä¸æ ·æœ¬æœ¬èº«çš„åˆ†æ•£ç¨‹åº¦çš„ç›¸è¿‘ç¨‹åº¦ã€‚æœ¬èº«æ˜¯åˆ†æ•£ç¨‹åº¦çš„å¯¹æ¯”ã€‚æœ€åç”¨1-è¿™ä¸ªå€¼ï¼Œ<strong>æœ€ç»ˆå€¼è¶Šå¤§è¡¨ç¤ºé¢„æµ‹å’Œæ ·æœ¬å€¼çš„åˆ†æ•£åˆ†å¸ƒç¨‹åº¦è¶Šç›¸è¿‘</strong>ã€‚</p>

:ET